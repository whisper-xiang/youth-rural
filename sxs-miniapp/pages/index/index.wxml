<view class="page">
  <!-- 顶部 Banner -->
  <view class="banner">
    <view class="banner-bg"></view>
    <!-- 流程指引按钮 -->
    <view class="process-guide-btn" bindtap="showProcessGuide">
      <view class="process-icon">📋</view>
    </view>
    <view class="banner-content">
      <view class="banner-icon">🌾</view>
      <view class="banner-text">
        <view class="banner-title">大学生暑期"三下乡"</view>
        <view class="banner-subtitle">社会实践活动管理系统</view>
      </view>
    </view>

    <!-- 登录按钮（未登录） -->
    <view class="banner-login" wx:if="{{!isLogin}}" bindtap="goLogin">
      <view class="login-avatar">👤</view>
      <view class="login-text">点击登录</view>
    </view>
  </view>

  <!-- 功能模块入口 (所有登录角色) -->
  <view class="module-section" wx:if="{{isLogin && modules.length > 0}}">
    <view class="section-header">
      <view class="section-title">功能模块</view>
      <view class="section-hint">根据您的身份显示</view>
    </view>
    <view class="module-grid">
      <view class="module-card" wx:for="{{modules}}" wx:key="key" bindtap="goToPage" data-url="{{item.url}}">
        <view class="module-icon-wrap">
          <view class="module-icon {{item.icon}}"></view>
        </view>
        <view class="module-info">
          <view class="module-name">{{item.name}}</view>
          <view class="module-desc">{{item.desc}}</view>
        </view>
        <view class="module-arrow">›</view>
      </view>
    </view>
  </view>

  <!-- 未登录提示 -->
  <view class="empty-section" wx:if="{{!isLogin}}">
    <view class="empty-icon">🔐</view>
    <view class="empty-title">请先登录</view>
    <view class="empty-desc">登录后可查看您的功能模块</view>
    <view class="empty-btn" bindtap="goLogin">立即登录</view>
  </view>

  <!-- 无模块提示 -->
  <view class="empty-section" wx:if="{{modules.length === 0 && isLogin && !isStudent}}">
    <view class="empty-icon">📋</view>
    <view class="empty-title">暂无可用模块</view>
    <view class="empty-desc">当前角色暂无可用功能模块</view>
  </view>
</view>

<!-- 流程指引弹窗 -->
<view class="process-modal" wx:if="{{showProcessModal}}">
  <view class="modal-mask" bindtap="hideProcessGuide"></view>
  <view class="modal-content">
    <view class="modal-header">
      <view class="modal-title">
        <text class="modal-icon">📋</text>
        <text>项目全流程</text>
      </view>
      <view class="modal-close" bindtap="hideProcessGuide">×</view>
    </view>
    <view class="modal-body">
      <view class="process-notice">
        <view class="notice-icon">💡</view>
        <view class="notice-text">
          <view class="notice-title">操作指南</view>
          <view class="notice-desc">项目一旦提交将进入审批流，立项后请及时在工作台记录实践点赞并上传成果。</view>
        </view>
      </view>
      <scroll-view class="process-scroll" scroll-y>
        <view class="process-step">
          <view class="step-number">1</view>
          <view class="step-info">
            <view class="step-title">项目申报 <text class="step-role">（学生）</text></view>
            <view class="step-desc">填写项目信息、成员名单及实践计划。提交后直接进入审批流程。</view>
          </view>
        </view>
        <view class="process-step">
          <view class="step-number">2</view>
          <view class="step-info">
            <view class="step-title">两级审核 <text class="step-role">（学院+学校）</text></view>
            <view class="step-desc">学院进行初审，学校进行终审。通过后项目正式立项。</view>
          </view>
        </view>
        <view class="process-step">
          <view class="step-number">3</view>
          <view class="step-info">
            <view class="step-title">立项实施 <text class="step-role">（团队）</text></view>
            <view class="step-desc">按计划开展活动，在小程序中记录实践进度，指导老师在线点评。</view>
          </view>
        </view>
        <view class="process-step">
          <view class="step-number">4</view>
          <view class="step-info">
            <view class="step-title">成果提交 <text class="step-role">（学生）</text></view>
            <view class="step-desc">实践结束，提交调研报告、视频等最终成果，作为评优依据。</view>
          </view>
        </view>
        <view class="process-step">
          <view class="step-number">5</view>
          <view class="step-info">
            <view class="step-title">专家评审 <text class="step-role">（专家）</text></view>
            <view class="step-desc">评审专家对提交的成果进行多维度匿名评分，确保公平公正。</view>
          </view>
        </view>
        <view class="process-step">
          <view class="step-number">6</view>
          <view class="step-info">
            <view class="step-title">评优结项 <text class="step-role">（校级管理员）</text></view>
            <view class="step-desc">公示评优排名与获奖等级，项目正式结项，生成社会实践证明。</view>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>
</view>
